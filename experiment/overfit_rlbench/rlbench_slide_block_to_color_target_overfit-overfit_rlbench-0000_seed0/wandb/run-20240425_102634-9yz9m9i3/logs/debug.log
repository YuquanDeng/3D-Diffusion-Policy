2024-04-25 10:26:34,083 INFO    MainThread:1931263 [wandb_setup.py:_flush():76] Current SDK version is 0.16.4
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_setup.py:_flush():76] Configure stats pid to 1931263
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_setup.py:_flush():76] Loading settings from /home/nil/.config/wandb/settings
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_setup.py:_flush():76] Loading settings from /home/nil/manipulation/3D-Diffusion-Policy/3D-Diffusion-Policy/wandb/settings
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'silent': 'True'}
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': '3D-Diffusion-Policy/train.py', 'program_abspath': '/home/nil/manipulation/3D-Diffusion-Policy/3D-Diffusion-Policy/train.py', 'program': 'train.py'}
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_init.py:_log_setup():526] Logging user logs to /home/nil/manipulation/3D-Diffusion-Policy/experiment/overfit_rlbench/rlbench_slide_block_to_color_target_overfit-overfit_rlbench-0000_seed0/wandb/run-20240425_102634-9yz9m9i3/logs/debug.log
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_init.py:_log_setup():527] Logging internal logs to /home/nil/manipulation/3D-Diffusion-Policy/experiment/overfit_rlbench/rlbench_slide_block_to_color_target_overfit-overfit_rlbench-0000_seed0/wandb/run-20240425_102634-9yz9m9i3/logs/debug-internal.log
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_init.py:init():566] calling init triggers
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_init.py:init():573] wandb.init called with sweep_config: {}
config: {'task': {'name': 'slide_block_to_color_target', 'task_name': 'train_diffusion_unet_hybrid', 'shape_meta': {'obs': {'point_cloud': {'shape': [1024, 6], 'type': 'point_cloud'}, 'agent_pos': {'shape': [8], 'type': 'low_dim'}}, 'action': {'shape': [8]}}, 'env_runner': {'_target_': 'diffusion_policy_3d.env_runner.rlbench_pointcloud_runner.RLBenchPointcloudRunner', 'n_obs_steps': 4, 'n_action_steps': 8, 'task_name': ['slide_block_to_color_target'], 'device': 'cuda:0', 'use_point_crop': True, 'num_points': 1024, 'tasks_to_eval': 'slide_block_to_color_target', 'cameras': ['front', 'left_shoulder', 'right_shoulder', 'wrist'], 'eval_datafolder': '/home/nil/manipulation/RVT2/rvt/data/128_1_var', 'start_episode': 0, 'eval_episodes': 2, 'episode_length': 200, 'record_every_n': -1, 'ground_truth': False, 'headless': True, 'save_video': True, 'log_dir': '/home/nil/manipulation/3D-Diffusion-Policy/debug', 'action_type': 'delta_action', 'rotation_resolution': 5, 'rotation_euler': False, 'task_bound': {'default': [-1, -100, 0.78, 100, 100, 100], 'remove_scene': [-1, -100, 0, 100, 100, 100], "remove_table'": [-1, -100, 0.6, 100, 100, 100], 'slide_block_to_color_target': [-0.4, -0.4, 0, 100, 0.4, 100]}}, 'dataset': {'_target_': 'diffusion_policy_3d.dataset.rlbench_pointcloud_dataset.RLBenchPointcloudDataset', 'zarr_path': '/home/nil/manipulation/3D-Diffusion-Policy/experiment/overfit_rlbench/rlbench_slide_block_to_color_target_quat_delta_action_expert.zarr', 'horizon': 16, 'pad_before': 3, 'pad_after': 7, 'seed': 42, 'val_ratio': 0.02, 'max_train_episodes': 90}}, 'name': 'train_diffusion_unet_hybrid', '_target_': 'diffusion_policy_3d.workspace.train_diffusion_rlbench_pointcloud_workspace.TrainDiffusionRLBenchPointcloudWorkspace', 'task_name': 'slide_block_to_color_target', 'shape_meta': {'obs': {'point_cloud': {'shape': [1024, 6], 'type': 'point_cloud'}, 'agent_pos': {'shape': [8], 'type': 'low_dim'}}, 'action': {'shape': [8]}}, 'exp_name': 'rlbench_slide_block_to_color_target_overfit-overfit_rlbench-0000', 'horizon': 16, 'n_obs_steps': 4, 'n_action_steps': 8, 'n_latency_steps': 0, 'dataset_obs_steps': 4, 'keypoint_visible_rate': 1.0, 'obs_as_global_cond': True, 'policy': {'_target_': 'diffusion_policy_3d.policy.diffusion_unet_hybrid_pointcloud_policy.DiffusionUnetHybridPointcloudPolicy', 'use_point_crop': True, 'condition_type': 'film', 'use_down_condition': True, 'use_mid_condition': True, 'use_up_condition': True, 'diffusion_step_embed_dim': 128, 'down_dims': [512, 1024, 2048], 'crop_shape': [80, 80], 'encoder_output_dim': 64, 'horizon': 16, 'kernel_size': 5, 'n_action_steps': 8, 'n_groups': 8, 'n_obs_steps': 4, 'noise_scheduler': {'_target_': 'diffusers.schedulers.scheduling_ddim.DDIMScheduler', 'num_train_timesteps': 100, 'beta_start': 0.0001, 'beta_end': 0.02, 'beta_schedule': 'squaredcos_cap_v2', 'clip_sample': True, 'set_alpha_to_one': True, 'steps_offset': 0, 'prediction_type': 'sample'}, 'num_inference_steps': 10, 'obs_as_global_cond': True, 'shape_meta': {'obs': {'point_cloud': {'shape': [1024, 6], 'type': 'point_cloud'}, 'agent_pos': {'shape': [8], 'type': 'low_dim'}}, 'action': {'shape': [8]}}, 'use_pc_color': True, 'pointnet_type': 'pointnet', 'se3_augmentation_cfg': {'use_aug': False, 'rotation': False, 'rotation_angle': [15, 15, 15], 'translation': True, 'translation_scale': 0.01, 'jitter': True, 'jitter_scale': 0.01}, 'pointcloud_encoder_cfg': {'in_channels': 3, 'out_channels': 64, 'use_layernorm': True, 'final_norm': 'layernorm', 'normal_channel': False}}, 'ema': {'_target_': 'diffusion_policy_3d.model.diffusion.ema_model.EMAModel', 'update_after_step': 0, 'inv_gamma': 1.0, 'power': 0.75, 'min_value': 0.0, 'max_value': 0.9999}, 'dataloader': {'batch_size': 128, 'num_workers': 8, 'shuffle': True, 'pin_memory': True, 'persistent_workers': False}, 'val_dataloader': {'batch_size': 128, 'num_workers': 8, 'shuffle': False, 'pin_memory': True, 'persistent_workers': False}, 'optimizer': {'_target_': 'torch.optim.AdamW', 'lr': 0.0001, 'betas': [0.95, 0.999], 'eps': 1e-08, 'weight_decay': 1e-06}, 'training': {'device': 'cuda:0', 'seed': 0, 'debug': False, 'resume': True, 'lr_scheduler': 'cosine', 'lr_warmup_steps': 500, 'num_epochs': 3000, 'gradient_accumulate_every': 1, 'use_ema': True, 'rollout_every': 200, 'checkpoint_every': 200, 'val_every': 1, 'sample_every': 5, 'max_train_steps': None, 'max_val_steps': None, 'tqdm_interval_sec': 1.0}, 'logging': {'group': 'rlbench_slide_block_to_color_target_overfit-overfit_rlbench-0000', 'id': None, 'mode': 'online', 'name': '0', 'project': 'diffusion_policy', 'resume': True, 'tags': ['train_diffusion_unet_hybrid', 'rlbench']}, 'checkpoint': {'save_ckpt': True, 'topk': {'monitor_key': 'test_mean_score', 'mode': 'max', 'k': 1, 'format_str': 'epoch={epoch:04d}-test_mean_score={test_mean_score:.3f}.ckpt'}, 'save_last_ckpt': True, 'save_last_snapshot': False}, 'multi_run': {'run_dir': 'data/outputs/2024.04.25/10.26.29_train_diffusion_unet_hybrid_slide_block_to_color_target', 'wandb_name_base': '2024.04.25-10.26.29_train_diffusion_unet_hybrid_slide_block_to_color_target'}}
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_init.py:init():616] starting backend
2024-04-25 10:26:34,084 INFO    MainThread:1931263 [wandb_init.py:init():620] setting up manager
2024-04-25 10:26:34,085 INFO    MainThread:1931263 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-04-25 10:26:34,086 INFO    MainThread:1931263 [wandb_init.py:init():628] backend started and connected
2024-04-25 10:26:34,090 INFO    MainThread:1931263 [wandb_init.py:init():720] updated telemetry
2024-04-25 10:26:34,142 INFO    MainThread:1931263 [wandb_init.py:init():753] communicating run to backend with 90.0 second timeout
2024-04-25 10:26:34,664 INFO    MainThread:1931263 [wandb_run.py:_on_init():2262] communicating current version
2024-04-25 10:26:34,868 INFO    MainThread:1931263 [wandb_run.py:_on_init():2271] got version response upgrade_message: "wandb version 0.16.6 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-04-25 10:26:34,868 INFO    MainThread:1931263 [wandb_init.py:init():804] starting run threads in backend
2024-04-25 10:26:40,500 INFO    MainThread:1931263 [wandb_run.py:_console_start():2241] atexit reg
2024-04-25 10:26:40,500 INFO    MainThread:1931263 [wandb_run.py:_redirect():2096] redirect: wrap_raw
2024-04-25 10:26:40,501 INFO    MainThread:1931263 [wandb_run.py:_redirect():2161] Wrapping output streams.
2024-04-25 10:26:40,501 INFO    MainThread:1931263 [wandb_run.py:_redirect():2186] Redirects installed.
2024-04-25 10:26:40,501 INFO    MainThread:1931263 [wandb_init.py:init():847] run started, returning control to user process
2024-04-25 10:26:40,501 INFO    MainThread:1931263 [wandb_run.py:_config_callback():1343] config_cb None None {'output_dir': '/home/nil/manipulation/3D-Diffusion-Policy/experiment/overfit_rlbench/rlbench_slide_block_to_color_target_overfit-overfit_rlbench-0000_seed0'}
2024-04-25 10:26:49,244 WARNING MsgRouterThr:1931263 [router.py:message_loop():77] message_loop has been closed
